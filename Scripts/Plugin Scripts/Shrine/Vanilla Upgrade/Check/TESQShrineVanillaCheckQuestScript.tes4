scn TESQShrineVanillaCheckQuestScript

float fQuestDelayTime
short iSearchItem
short iDisplayedMenu

short iChoice

short bFoundItem
short bFoundArmorSet
short bFoundWeaponSet

begin GameMode
	if iDisplayedMenu == 0
		if iSearchItem == 0
			if Player.GetItemCount EbonyBoots > 0
				set TEQQShrineVanillaEbonyArmorQuest.bEbonyBoots to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount EbonyCuirass > 0
				set TEQQShrineVanillaEbonyArmorQuest.bEbonyCuirass to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount EbonyGreaves > 0
				set TEQQShrineVanillaEbonyArmorQuest.bEbonyGreaves to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount EbonyGauntlets > 0
				set TEQQShrineVanillaEbonyArmorQuest.bEbonyGauntlets to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount EbonyHelmet > 0
				set TEQQShrineVanillaEbonyArmorQuest.bEbonyHelmet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount EbonyShield > 0
				set TEQQShrineVanillaEbonyArmorQuest.bEbonyShield to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DaedricBoots > 0
				set TEQQShrineVanillaDaedricArmorQuest.bDaedricBoots to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DaedricCuirass > 0
				set TEQQShrineVanillaDaedricArmorQuest.bDaedricCuirass to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DaedricGreaves > 0
				set TEQQShrineVanillaDaedricArmorQuest.bDaedricGreaves to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DaedricGauntlets > 0
				set TEQQShrineVanillaDaedricArmorQuest.bDaedricGauntlets to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DaedricHelmet > 0
				set TEQQShrineVanillaDaedricArmorQuest.bDaedricHelmet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DaedricShield > 0
				set TEQQShrineVanillaDaedricArmorQuest.bDaedricShield to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DwarvenBoots > 0
				set TEQQShrineVanillaDwarvenArmorQuest.bDwarvenBoots to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DwarvenCuirass > 0
				set TEQQShrineVanillaDwarvenArmorQuest.bDwarvenCuirass to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DwarvenGreaves > 0
				set TEQQShrineVanillaDwarvenArmorQuest.bDwarvenGreaves to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DwarvenGauntlets > 0
				set TEQQShrineVanillaDwarvenArmorQuest.bDwarvenGauntlets to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DwarvenHelmet > 0
				set TEQQShrineVanillaDwarvenArmorQuest.bDwarvenHelmet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount DwarvenShield > 0
				set TEQQShrineVanillaDwarvenArmorQuest.bDwarvenShield to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount ElvenBoots > 0
				set TEQQShrineVanillaElvenArmorQuest.bElvenBoots to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount ElvenCuirass > 0
				set TEQQShrineVanillaElvenArmorQuest.bElvenCuirass to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount ElvenGreaves > 0
				set TEQQShrineVanillaElvenArmorQuest.bElvenGreaves to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount ElvenGauntlets > 0
				set TEQQShrineVanillaElvenArmorQuest.bElvenGauntlets to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount ElvenHelmet > 0
				set TEQQShrineVanillaElvenArmorQuest.bElvenHelmet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount ElvenShield > 0
				set TEQQShrineVanillaElvenArmorQuest.bElvenShield to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFirstLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount MithrilBoots > 0
				set TEQQShrineVanillaMithrilArmorQuest.bMithrilBoots to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount MithrilCuirass > 0
				set TEQQShrineVanillaMithrilArmorQuest.bMithrilCuirass to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount MithrilGreaves > 0
				set TEQQShrineVanillaMithrilArmorQuest.bMithrilGreaves to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount MithrilGauntlets > 0
				set TEQQShrineVanillaMithrilArmorQuest.bMithrilGauntlets to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount MithrilHelmet > 0
				set TEQQShrineVanillaMithrilArmorQuest.bMithrilHelmet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount MithrilShield > 0
				set TEQQShrineVanillaMithrilArmorQuest.bMithrilShield to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundSecondLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount GlassBoots > 0
				set TEQQShrineVanillaGlassArmorQuest.bGlassBoots to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount GlassCuirass > 0
				set TEQQShrineVanillaGlassArmorQuest.bGlassCuirass to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount GlassGreaves > 0
				set TEQQShrineVanillaGlassArmorQuest.bGlassGreaves to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount GlassGauntlets > 0
				set TEQQShrineVanillaGlassArmorQuest.bGlassGauntlets to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount GlassHelmet > 0
				set TEQQShrineVanillaGlassArmorQuest.bGlassHelmet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount GlassShield > 0
				set TEQQShrineVanillaGlassArmorQuest.bGlassShield to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundThirdLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEMadnessBoots1 > 0 || Player.GetItemCount SEMadnessBoots2 > 0 || Player.GetItemCount SEMadnessBoots3 > 0 || Player.GetItemCount SEMadnessBoots4 > 0 || Player.GetItemCount SEMadnessBoots5 > 0 || Player.GetItemCount SEMadnessBoots6 > 0
				set TEQQShrineVanillaMadnessHArmorQuest.bMadnessHBoots to 1
				set TEQQShrineVanillaMadnessLArmorQuest.bMadnessLBoots to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEMadnessCuirass1 > 0 || Player.GetItemCount SEMadnessCuirass2 > 0 || Player.GetItemCount SEMadnessCuirass3 > 0 || Player.GetItemCount SEMadnessCuirass4 > 0 || Player.GetItemCount SEMadnessCuirass5 > 0 || Player.GetItemCount SEMadnessCuirass6 > 0
				set TEQQShrineVanillaMadnessHArmorQuest.bMadnessHCuirass to 1
				set TEQQShrineVanillaMadnessLArmorQuest.bMadnessLCuirass to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEMadnessGauntlets1 > 0 || Player.GetItemCount SEMadnessGauntlets2 > 0 || Player.GetItemCount SEMadnessGauntlets3 > 0 || Player.GetItemCount SEMadnessGauntlets4 > 0 || Player.GetItemCount SEMadnessGauntlets5 > 0 || Player.GetItemCount SEMadnessGauntlets6 > 0
				set TEQQShrineVanillaMadnessHArmorQuest.bMadnessHGauntlets to 1
				set TEQQShrineVanillaMadnessLArmorQuest.bMadnessLGauntlets to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEMadnessGreaves1 > 0 || Player.GetItemCount SEMadnessGreaves2 > 0 || Player.GetItemCount SEMadnessGreaves3 > 0 || Player.GetItemCount SEMadnessGreaves4 > 0 || Player.GetItemCount SEMadnessGreaves5 > 0 || Player.GetItemCount SEMadnessGreaves6 > 0
				set TEQQShrineVanillaMadnessHArmorQuest.bMadnessHGreaves to 1
				set TEQQShrineVanillaMadnessLArmorQuest.bMadnessLGreaves to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEMadnessHelmet1 > 0 || Player.GetItemCount SEMadnessHelmet2 > 0 || Player.GetItemCount SEMadnessHelmet3 > 0 || Player.GetItemCount SEMadnessHelmet4 > 0 || Player.GetItemCount SEMadnessHelmet5 > 0 || Player.GetItemCount SEMadnessHelmet6 > 0
				set TEQQShrineVanillaMadnessHArmorQuest.bMadnessHHelmet to 1
				set TEQQShrineVanillaMadnessLArmorQuest.bMadnessLHelmet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set bFoundItem to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEMadnessShield1 > 0 || Player.GetItemCount SEMadnessShield2 > 0 || Player.GetItemCount SEMadnessShield3 > 0 || Player.GetItemCount SEMadnessShield4 > 0 || Player.GetItemCount SEMadnessShield5 > 0 || Player.GetItemCount SEMadnessShield6 > 0
				set TEQQShrineVanillaMadnessHArmorQuest.bMadnessHShield to 1
				set TEQQShrineVanillaMadnessLArmorQuest.bMadnessLShield to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFourthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEAmberBoots1 > 0 || Player.GetItemCount SEAmberBoots2 > 0 || Player.GetItemCount SEAmberBoots3 > 0 || Player.GetItemCount SEAmberBoots4 > 0 || Player.GetItemCount SEAmberBoots5 > 0 || Player.GetItemCount SEAmberBoots6 > 0
				set TEQQShrineVanillaAmberHArmorQuest.bAmberHBoots to 1
				set TEQQShrineVanillaAmberLArmorQuest.bAmberLBoots to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEAmberCuirass1 > 0 || Player.GetItemCount SEAmberCuirass2 > 0 || Player.GetItemCount SEAmberCuirass3 > 0 || Player.GetItemCount SEAmberCuirass4 > 0 || Player.GetItemCount SEAmberCuirass5 > 0 || Player.GetItemCount SEAmberCuirass6 > 0
				set TEQQShrineVanillaAmberHArmorQuest.bAmberHCuirass to 1
				set TEQQShrineVanillaAmberLArmorQuest.bAmberLCuirass to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEAmberGreaves1 > 0 || Player.GetItemCount SEAmberGreaves2 > 0 || Player.GetItemCount SEAmberGreaves3 > 0 || Player.GetItemCount SEAmberGreaves4 > 0 || Player.GetItemCount SEAmberGreaves5 > 0 || Player.GetItemCount SEAmberGreaves6 > 0
				set TEQQShrineVanillaAmberHArmorQuest.bAmberHGreaves to 1
				set TEQQShrineVanillaAmberLArmorQuest.bAmberLGreaves to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEAmberGauntlets1 > 0 || Player.GetItemCount SEAmberGauntlets2 > 0 || Player.GetItemCount SEAmberGauntlets3 > 0 || Player.GetItemCount SEAmberGauntlets4 > 0 || Player.GetItemCount SEAmberGauntlets5 > 0 || Player.GetItemCount SEAmberGauntlets6 > 0
				set TEQQShrineVanillaAmberHArmorQuest.bAmberHGauntlets to 1
				set TEQQShrineVanillaAmberLArmorQuest.bAmberLGauntlets to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEAmberHelmet1 > 0 || Player.GetItemCount SEAmberHelmet2 > 0 || Player.GetItemCount SEAmberHelmet3 > 0 || Player.GetItemCount SEAmberHelmet4 > 0 || Player.GetItemCount SEAmberHelmet5 > 0 || Player.GetItemCount SEAmberHelmet6 > 0
				set TEQQShrineVanillaAmberHArmorQuest.bAmberHHelmet to 1
				set TEQQShrineVanillaAmberLArmorQuest.bAmberLHelmet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			if Player.GetItemCount SEAmberShield1 > 0 || Player.GetItemCount SEAmberShield2 > 0 || Player.GetItemCount SEAmberShield3 > 0 || Player.GetItemCount SEAmberShield4 > 0 || Player.GetItemCount SEAmberShield5 > 0 || Player.GetItemCount SEAmberShield6 > 0
				set TEQQShrineVanillaAmberHArmorQuest.bAmberHShield to 1
				set TEQQShrineVanillaAmberLArmorQuest.bAmberLShield to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundLArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundFifthHArmorSet to 1
				set TEQQShrineVanillaCheckArmorQuest.bFoundHArmorSet to 1
				set bFoundItem to 1
				set bFoundArmorSet to 1
			endif
			set iSearchItem to 1
		elseif iSearchItem == 1
			if bFoundItem == 0
				set iDisplayedMenu to -1
			elseif bFoundItem == 1
				if bFoundWeaponSet == 1 && bFoundArmorSet == 1
					MessageBox "Found Both Weapons and Armor to Upgrade", "Cancel", "Weapons", "Armor"
					set iSearchItem to 2
				elseif bFoundWeaponSet == 1 && bFoundArmorSet == 0
					set iSearchItem to 3
				elseif bFoundWeaponSet == 0 && bFoundArmorSet == 1
					set iSearchItem to 4
				endif
			endif
		elseif iSearchItem == 2
		set iChoice to GetButtonPressed
			if iChoice == 0
				set iDisplayedMenu to -2
			elseif iChoice == 1
				set iSearchItem to 3
			elseif iChoice == 2
				set iSearchItem to 4
			endif
		elseif iSearchItem == 3
			set iDisplayedMenu to 1
		elseif iSearchItem == 4
			set iDisplayedMenu to 2
		endif
	elseif iDisplayedMenu == -1
		MessageBox "Nothing found to upgrade!"
		StopQuest TEQQShrineVanillaCheckQuest
	elseif iDisplayedMenu == -2
		Message "Return when you are ready!"
		StopQuest TEQQShrineVanillaCheckQuest
	elseif iDisplayedMenu == -3
		set TEQQShrineInitilizationQuest.iDisplayedMenu to -9
		StopQuest TEQQShrineVanillaCheckQuest
		StartQuest TEQQShrineInitilizationQuest
	elseif iDisplayedMenu == 1
	;	set TEQQShrineVanillaCheckWeaponQuest.fQuestDelayTime to 0.01
	;	set TEQQShrineVanillaCheckWeaponQuest.iDisplayedMenu to 0
	;	set TEQQShrineVanillaCheckWeaponQuest.iSelectedSubWeaponSet to 0
	;	set TEQQShrineVanillaCheckWeaponQuest.iSelectedWeaponSet to 0
	;	set TEQQShrineVanillaCheckWeaponQuest.iChoosingSubWeaponSet to 0
	;	set TEQQShrineVanillaCheckWeaponQuest.iChoosingWeaponSet to 0
	;	set TEQQShrineVanillaCheckWeaponQuest.iSearchItem to 0
	;	set TEQQShrineVanillaCheckWeaponQuest.iFoundWeaponSet to 0
	;	set TEQQShrineVanillaCheckWeaponQuest.iFoundBowWeaponSet to 0
	;	set TEQQShrineVanillaCheckWeaponQuest.iFound2HWeaponSet to 0
	;	set TEQQShrineVanillaCheckWeaponQuest.iFound1HBluntWeaponSet to 0
	;	set TEQQShrineVanillaCheckWeaponQuest.iFound1HBladeWeaponSet to 0
	;	set TEQQShrineVanillaCheckWeaponQuest.iFound0HWeaponSet to 0
	;	StopQuest TEQQShrineVanillaCheckQuest
	;	StartQuest TEQQShrineVanillaCheckWeaponQuest
	elseif iDisplayedMenu == 2
		StopQuest TEQQShrineVanillaCheckQuest
		StartQuest TEQQShrineVanillaCheckArmorQuest
	endif                    
end                          
